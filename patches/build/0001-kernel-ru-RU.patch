From d0e76043866a50643037045be5748379ea6731c0 Mon Sep 17 00:00:00 2001
From: ksrt12 <kazakov12stepan2012@live.ru>
Date: Fri, 18 Dec 2015 14:29:53 +0600
Subject: [PATCH] kernel ru RU

Change-Id: Ie8b62e829951b2d92725441164c23d209306c693
---
 CleanSpec.mk                |  5 +++++
 core/tasks/kernel.mk        | 12 +++++++++++-
 target/product/full_base.mk |  2 +-
 3 files changed, 17 insertions(+), 2 deletions(-)

diff --git a/CleanSpec.mk b/CleanSpec.mk
index 64d84e3..d264da0 100644
--- a/CleanSpec.mk
+++ b/CleanSpec.mk
@@ -371,6 +371,11 @@ $(call add-clean-step, rm -rf $(PRODUCT_OUT)/obj/APPS/*)
 
 $(call add-clean-step, rm -rf $(PRODUCT_OUT)/system/build.prop)
 
+# Kernel
+$(call add-clean-step, rm -rf $(PRODUCT_OUT)/system/lib/modules/*)
+$(call add-clean-step, rm -rf $(PRODUCT_OUT)/obj/KERNRL_OBJ/*)
+
+
 # ************************************************
 # NEWER CLEAN STEPS MUST BE AT THE END OF THE LIST
 # ************************************************
diff --git a/core/tasks/kernel.mk b/core/tasks/kernel.mk
index d1d24d6..e4c562d 100644
--- a/core/tasks/kernel.mk
+++ b/core/tasks/kernel.mk
@@ -186,7 +186,17 @@ ifneq ($(USE_CCACHE),)
     ccache := $(strip $(wildcard $(ccache)))
 endif
 
-KERNEL_CROSS_COMPILE := CROSS_COMPILE="$(ccache) $(KERNEL_TOOLCHAIN_PATH)"
+ifneq ($(TARGET_KERNEL_CUSTOM_TOOLCHAIN),)
+    ifeq ($(HOST_OS),darwin)
+        TARGET_KERNEL_CUSTOM_TOOLCHAIN_PATH := prebuilt/darwin-x86/toolchain
+    else
+        TARGET_KERNEL_CUSTOM_TOOLCHAIN_PATH := prebuilt/linux-x86/toolchain
+    endif
+MOD_TOOL := $(ANDROID_BUILD_TOP)/$(TARGET_KERNEL_CUSTOM_TOOLCHAIN_PATH)/$(TARGET_KERNEL_CUSTOM_TOOLCHAIN)
+else
+MOD_TOOL := $(KERNEL_TOOLCHAIN_PATH)
+endif
+KERNEL_CROSS_COMPILE := CROSS_COMPILE="$(ccache) $(MOD_TOOL)"
 ccache =
 
 define mv-modules
diff --git a/target/product/full_base.mk b/target/product/full_base.mk
index bac3e03..76c9fc7 100644
--- a/target/product/full_base.mk
+++ b/target/product/full_base.mk
@@ -24,7 +24,7 @@ PRODUCT_PACKAGES := \
     WAPPushManager
 
 # Put en_US first in the list, so make it default.
-PRODUCT_LOCALES := en_US
+PRODUCT_LOCALES := ru_RU
 
 # Get some sounds
 $(call inherit-product-if-exists, frameworks/base/data/sounds/AllAudio.mk)
-- 
2.6.4

